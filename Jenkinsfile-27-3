def unit = {
  pyTest 'tests/unit'
}

def integration = {
  pyTest 'tests/integration', "-m 'not compress and not serial'"
}

def sanity = {
  pyTest 'tests/sanity', "-m 'not compress and not serial'"
}

env.PYTHONPATH = '.:..'  // So that the src directory can be used as a dir


ahlPython {
    buildLabel='ts2-el7'
    labels='ts2-el7'
    buildPinnedEgg = true
    dockerPath = 'docker-27-3'
    medusaVersions = [
        build: ['27-3'],
        test: ['27-3'],
        docker: ['27-3']
    ]
    publicProject = true
    setup_cfg = 'setup-legacy.cfg'
    testStages =  [
        [name: 'Sanity checks',
         body: sanity,
        ],
        [name: 'Unit',
         body: unit,
        ],
        [name: 'Integration',
         body: integration,
         workers: 1
        ],
    ]
}
